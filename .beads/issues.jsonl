{"id":"tanstack-db-electric-bun-5bh","title":"Migrate routers to oRPC handlers","description":"Convert tRPC routers to oRPC:\n\nsrc/lib/trpc/todos.ts → src/lib/orpc/routers/todos.ts\nsrc/lib/trpc/projects.ts → src/lib/orpc/routers/projects.ts\nsrc/lib/trpc/users.ts → src/lib/orpc/routers/users.ts\n\nPattern changes:\n- router({...}) → plain object with procedures\n- .input(zodSchema) → .input(arktypeSchema)\n- TRPCError → ORPCError\n- ctx → context","notes":"Starting router migration from tRPC to oRPC","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T15:19:36.688046+07:00","updated_at":"2025-12-25T15:34:16.893603+07:00","closed_at":"2025-12-25T15:34:16.893603+07:00","close_reason":"Migrated routers from tRPC to oRPC: todos.ts, projects.ts, users.ts. Changed TRPCError to ORPCError, router({}) to plain objects, .mutation to .handler pattern","dependencies":[{"issue_id":"tanstack-db-electric-bun-5bh","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:22:06.16457+07:00","created_by":"masrurimz"},{"issue_id":"tanstack-db-electric-bun-5bh","depends_on_id":"tanstack-db-electric-bun-rr8","type":"blocks","created_at":"2025-12-25T15:23:04.791456+07:00","created_by":"masrurimz"},{"issue_id":"tanstack-db-electric-bun-5bh","depends_on_id":"tanstack-db-electric-bun-7vi","type":"blocks","created_at":"2025-12-25T15:23:10.31244+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-5qf","title":"Migrate from tRPC + Zod to oRPC + Arktype","description":"Migrate the tanstack-db-electric-bun starter from tRPC with Zod validation to oRPC with Arktype validation. Use alkhidmah-digital-platform as reference implementation.\n\nCURRENT STATE:\n- tRPC v11 with Zod v4 validation\n- drizzle-zod for schema generation\n- 3 routers: todos, projects, users\n- Collections call trpc client for mutations\n\nTARGET STATE:\n- oRPC with Arktype validation\n- drizzle-arktype for schema generation\n- Same functionality, cleaner patterns\n\nREFERENCE:\n- /Users/masrurimz/Projects/alkhidmah/alkhidmah-digital-platform/apps/web/src/lib/orpc/","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-25T15:18:38.445182+07:00","updated_at":"2025-12-25T15:40:07.54057+07:00","closed_at":"2025-12-25T15:40:07.54057+07:00","close_reason":"Migration complete: tRPC + Zod replaced with oRPC + Arktype. All 8 subtasks completed."}
{"id":"tanstack-db-electric-bun-64p","title":"Setup message files and translations","description":"Create messages/en.json and messages/de.json with sample translations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T17:13:14.874527+07:00","updated_at":"2025-12-25T17:33:17.865661+07:00","closed_at":"2025-12-25T17:33:17.865661+07:00","close_reason":"Completed - Created messages/en.json and messages/de.json with translations","dependencies":[{"issue_id":"tanstack-db-electric-bun-64p","depends_on_id":"tanstack-db-electric-bun-81k","type":"parent-child","created_at":"2025-12-25T17:15:22.752451+07:00","created_by":"daemon"}]}
{"id":"tanstack-db-electric-bun-7r4","title":"Migrate db/schema.ts from drizzle-zod to drizzle-arktype","description":"Convert schema generation from Zod to Arktype:\n\nCURRENT: drizzle-zod with createSchemaFactory\nTARGET: drizzle-arktype with createSelectSchema/createInsertSchema\n\nType inference changes from z.infer to typeof Schema.infer","notes":"Starting schema migration from drizzle-zod to drizzle-arktype","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T15:19:06.533911+07:00","updated_at":"2025-12-25T15:31:54.156273+07:00","closed_at":"2025-12-25T15:31:54.156273+07:00","close_reason":"Migrated db/schema.ts from drizzle-zod to drizzle-arktype. Changed createSchemaFactory to direct imports, updated type inference from z.infer to typeof Schema.infer","dependencies":[{"issue_id":"tanstack-db-electric-bun-7r4","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:21:55.163803+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-7vi","title":"Create oRPC API handler route","description":"Create src/routes/api/rpc/$.ts (or src/routes/api/$.ts)\n\n- RPCHandler or OpenAPIHandler\n- Mount router with context\n- Remove old src/routes/api/trpc/$.ts","notes":"Creating oRPC API handler route","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T15:20:03.530812+07:00","updated_at":"2025-12-25T15:35:45.215787+07:00","closed_at":"2025-12-25T15:35:45.215787+07:00","close_reason":"Created src/routes/api/rpc/$.ts with RPCHandler using createServerFileRoute pattern","dependencies":[{"issue_id":"tanstack-db-electric-bun-7vi","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:22:17.23828+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-7y5","title":"Install and configure Paraglide JS","description":"Install @inlang/paraglide-js, run init, configure vite plugin","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T17:13:14.507685+07:00","updated_at":"2025-12-25T17:33:17.461585+07:00","closed_at":"2025-12-25T17:33:17.461585+07:00","close_reason":"Completed - Paraglide JS installed and configured in vite.config.ts","dependencies":[{"issue_id":"tanstack-db-electric-bun-7y5","depends_on_id":"tanstack-db-electric-bun-81k","type":"parent-child","created_at":"2025-12-25T17:15:22.354525+07:00","created_by":"daemon"},{"issue_id":"tanstack-db-electric-bun-7y5","depends_on_id":"tanstack-db-electric-bun-64p","type":"blocks","created_at":"2025-12-25T17:15:39.849137+07:00","created_by":"daemon"},{"issue_id":"tanstack-db-electric-bun-7y5","depends_on_id":"tanstack-db-electric-bun-b4l","type":"blocks","created_at":"2025-12-25T17:15:40.218228+07:00","created_by":"daemon"},{"issue_id":"tanstack-db-electric-bun-7y5","depends_on_id":"tanstack-db-electric-bun-ba3","type":"blocks","created_at":"2025-12-25T17:15:40.654036+07:00","created_by":"daemon"},{"issue_id":"tanstack-db-electric-bun-7y5","depends_on_id":"tanstack-db-electric-bun-shw","type":"blocks","created_at":"2025-12-25T17:15:41.038454+07:00","created_by":"daemon"}]}
{"id":"tanstack-db-electric-bun-81k","title":"Integrate Paraglide JS for internationalization","description":"Add i18n support using Paraglide JS with SSR, URL-based locale routing, and cookie persistence. Must integrate with existing TanStack Start + oRPC + Electric SQL patterns.","design":"## Architecture (Simplified based on official example)\n1. **Vite Plugin**: Add paraglideVitePlugin BEFORE tanstackStart() - handles all locale logic\n2. **Built-in Strategy**: ['url', 'cookie', 'preferredLanguage', 'baseLocale'] - no custom middleware needed\n3. **URL Patterns**: Define in vite plugin config for /en/*, /de/* routing\n4. **Cookie**: Built into plugin via cookieName option (PARAGLIDE_LOCALE)\n\n## Detection Order (handled by plugin)\nURL path → cookie → Accept-Language header → baseLocale (en)\n\n## Key Files\n- vite.config.ts: paraglideVitePlugin config\n- project.inlang/settings.json: locale config\n- messages/*.json: translation files\n- src/paraglide/: generated output","acceptance_criteria":"- [ ] Paraglide JS installed and configured in vite.config.ts\n- [ ] project.inlang initialized with message files (en, de)\n- [ ] URL-based locale routing works (/en/*, /de/*)\n- [ ] Locale cookie persists user preference\n- [ ] SSR renders correct locale on server\n- [ ] Hydration maintains locale without flicker\n- [ ] html lang attribute reflects current locale\n- [ ] LocaleSwitcher component works\n- [ ] oRPC errors can be localized\n- [ ] Build passes with no type errors","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-25T17:12:36.689335+07:00","updated_at":"2025-12-25T17:33:29.260489+07:00","closed_at":"2025-12-25T17:33:29.260489+07:00","close_reason":"Completed - Paraglide JS i18n integrated with URL-based routing, cookie persistence, and LocaleSwitcher component"}
{"id":"tanstack-db-electric-bun-9fj","title":"Update package.json dependencies","description":"Remove tRPC deps, add oRPC and arktype deps:\n\nREMOVE:\n- @trpc/client\n- @trpc/server\n- drizzle-zod\n- zod\n\nADD:\n- @orpc/server\n- @orpc/client\n- @orpc/openapi (optional, for docs)\n- arktype\n- drizzle-arktype","notes":"Starting package.json migration: removing tRPC/Zod deps, adding oRPC/Arktype deps","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T15:18:52.922419+07:00","updated_at":"2025-12-25T15:30:45.22502+07:00","closed_at":"2025-12-25T15:30:45.22502+07:00","close_reason":"Updated package.json: removed @trpc/client, @trpc/server, drizzle-zod, zod; added @orpc/client, @orpc/server, arktype, drizzle-arktype","dependencies":[{"issue_id":"tanstack-db-electric-bun-9fj","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:21:49.63827+07:00","created_by":"masrurimz"},{"issue_id":"tanstack-db-electric-bun-9fj","depends_on_id":"tanstack-db-electric-bun-7r4","type":"blocks","created_at":"2025-12-25T15:22:48.159674+07:00","created_by":"masrurimz"},{"issue_id":"tanstack-db-electric-bun-9fj","depends_on_id":"tanstack-db-electric-bun-kcy","type":"blocks","created_at":"2025-12-25T15:22:53.625507+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-b4l","title":"Implement URL-based locale routing","description":"Add locale param route, redirect from / to default locale","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T17:13:15.243647+07:00","updated_at":"2025-12-25T17:33:19.096708+07:00","closed_at":"2025-12-25T17:33:19.096708+07:00","close_reason":"Completed - URL-based locale routing configured via urlPatterns in vite.config.ts","dependencies":[{"issue_id":"tanstack-db-electric-bun-b4l","depends_on_id":"tanstack-db-electric-bun-81k","type":"parent-child","created_at":"2025-12-25T17:15:23.122729+07:00","created_by":"daemon"}]}
{"id":"tanstack-db-electric-bun-ba3","title":"Add Nitro middleware for locale detection","description":"Create middleware to parse locale from URL/cookie/Accept-Language, set cookie, attach to context","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T17:13:15.591852+07:00","updated_at":"2025-12-25T17:27:55.912168+07:00","closed_at":"2025-12-25T17:27:55.912168+07:00","close_reason":"Not needed - Paraglide Vite plugin handles locale detection via built-in strategy option","dependencies":[{"issue_id":"tanstack-db-electric-bun-ba3","depends_on_id":"tanstack-db-electric-bun-81k","type":"parent-child","created_at":"2025-12-25T17:15:23.514232+07:00","created_by":"daemon"},{"issue_id":"tanstack-db-electric-bun-ba3","depends_on_id":"tanstack-db-electric-bun-lzi","type":"blocks","created_at":"2025-12-25T17:15:41.412716+07:00","created_by":"daemon"}]}
{"id":"tanstack-db-electric-bun-bbb","title":"Update collections.ts to use oRPC client","description":"Update src/lib/collections.ts\n\nChange: trpc.todos.create.mutate → orpc.todos.create(...)\nSame for projects and users collections","notes":"Updating collections.ts to use oRPC client","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T15:20:16.58901+07:00","updated_at":"2025-12-25T15:36:40.908877+07:00","closed_at":"2025-12-25T15:36:40.908877+07:00","close_reason":"Updated collections.ts: replaced trpc import with orpc, changed .mutate() calls to direct function calls","dependencies":[{"issue_id":"tanstack-db-electric-bun-bbb","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:22:22.712445+07:00","created_by":"masrurimz"},{"issue_id":"tanstack-db-electric-bun-bbb","depends_on_id":"tanstack-db-electric-bun-nco","type":"blocks","created_at":"2025-12-25T15:23:21.294309+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-kcy","title":"Create oRPC base procedures and context","description":"Create src/lib/orpc/index.ts and src/lib/orpc/context.ts\n\n- os.$context\u003cContext\u003e() for base\n- publicProcedure and protectedProcedure (with auth middleware)\n- generateTxId helper function\n- Context type with session and db","notes":"Creating oRPC base procedures and context files","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T15:19:22.450633+07:00","updated_at":"2025-12-25T15:33:00.481487+07:00","closed_at":"2025-12-25T15:33:00.481487+07:00","close_reason":"Created src/lib/orpc/context.ts and src/lib/orpc/index.ts with createContext, publicProcedure, protectedProcedure, and generateTxId helper","dependencies":[{"issue_id":"tanstack-db-electric-bun-kcy","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:22:00.688833+07:00","created_by":"masrurimz"},{"issue_id":"tanstack-db-electric-bun-kcy","depends_on_id":"tanstack-db-electric-bun-5bh","type":"blocks","created_at":"2025-12-25T15:22:59.320354+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-lzi","title":"Create LocaleSwitcher component","description":"Component to switch locales with cookie persistence and URL update","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T17:13:16.285631+07:00","updated_at":"2025-12-25T17:33:18.703758+07:00","closed_at":"2025-12-25T17:33:18.703758+07:00","close_reason":"Completed - Created LocaleSwitcher component in src/components/locale-switcher.tsx","dependencies":[{"issue_id":"tanstack-db-electric-bun-lzi","depends_on_id":"tanstack-db-electric-bun-81k","type":"parent-child","created_at":"2025-12-25T17:15:24.257796+07:00","created_by":"daemon"}]}
{"id":"tanstack-db-electric-bun-nco","title":"Cleanup old tRPC files","description":"Remove after migration complete:\n- src/lib/trpc.ts\n- src/lib/trpc-client.ts\n- src/lib/trpc/ directory\n- src/routes/api/trpc/ directory\n- Update AGENTS.md if needed","notes":"Cleaning up old tRPC files","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T15:20:30.124891+07:00","updated_at":"2025-12-25T15:40:07.176791+07:00","closed_at":"2025-12-25T15:40:07.176791+07:00","close_reason":"Removed old tRPC files: src/lib/trpc.ts, src/lib/trpc-client.ts, src/lib/trpc/, src/routes/api/trpc/","dependencies":[{"issue_id":"tanstack-db-electric-bun-nco","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:22:28.196372+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-rr8","title":"Create oRPC client","description":"Create src/lib/orpc/client.ts\n\n- createORPCClient with RPCLink\n- Export typed orpc client for collections","notes":"Creating oRPC client","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T15:19:50.11388+07:00","updated_at":"2025-12-25T15:34:48.537839+07:00","closed_at":"2025-12-25T15:34:48.537839+07:00","close_reason":"Created src/lib/orpc/client.ts with createORPCClient and RPCLink","dependencies":[{"issue_id":"tanstack-db-electric-bun-rr8","depends_on_id":"tanstack-db-electric-bun-5qf","type":"parent-child","created_at":"2025-12-25T15:22:11.658275+07:00","created_by":"masrurimz"},{"issue_id":"tanstack-db-electric-bun-rr8","depends_on_id":"tanstack-db-electric-bun-bbb","type":"blocks","created_at":"2025-12-25T15:23:15.829944+07:00","created_by":"masrurimz"}]}
{"id":"tanstack-db-electric-bun-shw","title":"Update root route for SSR locale support","description":"Use createRootRouteWithContext, set html lang attribute dynamically","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T17:13:15.934994+07:00","updated_at":"2025-12-25T17:33:18.255327+07:00","closed_at":"2025-12-25T17:33:18.255327+07:00","close_reason":"Completed - Updated __root.tsx with dynamic lang={getLocale()} attribute","dependencies":[{"issue_id":"tanstack-db-electric-bun-shw","depends_on_id":"tanstack-db-electric-bun-81k","type":"parent-child","created_at":"2025-12-25T17:15:23.88696+07:00","created_by":"daemon"}]}
